# Криптовалютный торговый бот с ИИ-сигналами AIgnal.tech
Простой, но легко расширяемый торговый бот, который использует ML-сигналы от API [AIgnal.tech](https://aignal.tech/) для их интерпретации, и принятии решений по работе с биржей. В настоящее время интегрирован лишь клиент для работы с биржей [OKX](https://okx.com/join/63825848), но вы можете добавить свои в модуль clients.

### Пожалуйста, дочитайте до конца!

________________________________________
## Для работы торгового бота потребуется:

- Зарегистрироваться на бирже → [OKX](https://okx.com/join/63825848)

- Получить api_key, secret_key, passphrase:

![Пример](https://github.com/Bednyakov/aignal-trading-bot/blob/main/static/okxapi.png)

________________________________________
## Настройка торгового бота

- Настраиваемые фильтры расположены в файле config.json.

- Все параметры риска и фильтров можно тонко настраивать, экспериментировать с комбинациями.

- При желании, можно сделать несколько таких config.jsonc под разные стратегии и запускать бота с разными конфигами.

### Пример config.json с комментариями
```
{
  "okx": {
    "api_key": "YOUR_OKX_API_KEY",          // Ключ API OKX (из личного кабинета)
    "secret_key": "YOUR_OKX_SECRET",        // Секрет API OKX
    "passphrase": "YOUR_OKX_PASSPHRASE",    // Пароль от API OKX
    "base_url": "https://www.okx.com",      // URL API
    "simulated_trading": false              // true, если используете демо-счет
  },

  "ml_api": {
    "endpoint": "https://aignal.tech/chart-data-btc-usdt-1h", // URL к ML API, который отдаёт прогноз
    "poll_interval_seconds": 3600,         // Интервал опроса ML API (секунды). Для часового эндпойнта, который указан выше, 3600 секунд.
    "symbol": null,                        // Инструмент для торговли (например ETH-USDT), для стандартного URL не используется.
    "api-key": null                        // API ключ для закрытых инструментов.
  },

  "strategy": {
    "enabled": true,                       // Включение/выключение стратегии

    "mode": "signal",                      // Режим стратегии (например: "signal" — следуем сигналу моделей)
    "sell_on_profit_usd": 100,             // продать сохраненную позицию, если прибыль > 100 USDT
    "sell_on_return": 0.005,               // или если доходность > 0.5%

    "signal_whitelist": ["buy", "sell"],   // Разрешённые сигналы для торговли
    "min_confidence": 0.6,                 // Минимальная уверенность моделей (0..1), ниже — сигнал игнорируется
    "min_profit_after_fee": 0.0005,        // Минимальная ожидаемая доходность (в долях, т.е. 0.0005 = 0.05%)

    "use_expected_price": true,            // Использовать "expected_price" из прогноза вместо текущей цены
    "order_type": "limit",                 // Тип ордера: "limit" или "market"
    "limit_price_slippage": 0.001,         // Допустимое отклонение (0.1%) при выставлении лимитного ордера

    "position_size": {
      "mode": "percent",                   // Режим расчёта объёма: "percent" (доля от баланса) или "fixed"
      "percent_of_balance": 0.05,          // 5% от доступного баланса в USDT будет использовано в сделке
      "fixed_size": null                   // Если mode="fixed", укажите фиксированный размер (например 0.01 BTC)
    },

    "risk": {
      "max_exposure_usd": 1000.0,          // Максимальная сумма (в USDT), которую можно задействовать в одной сделке
      "max_open_positions": 3              // Максимальное количество одновременно открытых позиций
    },

    "exit": {
      "take_profit_pct": 0.01,             // Тейк-профит: +1% от цены входа
      "stop_loss_pct": -0.005              // Стоп-лосс: -0.5% от цены входа
    },

    "order_management": {
      "cancel_if_unfilled_after_sec": 120, // Автоотмена ордера, если он не исполнен за 120 секунд
      "monitor_open_orders_every_sec": 15  // Интервал проверки открытых ордеров
    },

    "dry_run": true,                       // true = тестовый режим (бот не будет выставлять ордера)
    "log_level": "INFO"                    // Уровень логов: DEBUG / INFO / WARNING / ERROR
  }
}
```

## Как бот использует ML-сигнал и настроенный config.json:

- signal (buy/sell) → основной драйвер решения (если не в signal_whitelist, игнорируем).

- confidence → сравниваем с min_confidence.

- profit_after_fee → используется в фильтре min_profit_after_fee (позволяет фильтровать «малоприбыльные» прогнозы).

- expected_price / current_price → по use_expected_price выбирается начальный base для расчёта limit-цены.

- transaction_cost и threshold_used — доступны в данных и вы можете расширить стратегию (например, более консервативное поведение при высоком threshold_used).

- predicted_return — используйте для динамической корректировки take_profit_pct (в текущей реализации TP/SL статичны в конфиге, но легко расширяются).

________________________________________
## Безопасность и тестирование
- Сначала запускайте с dry_run: true. Убедитесь, что логика размера позиции и цены работает ожидаемо.

- Никогда не храните ключи в публичных репозиториях; используйте окружение или защищённые секреты на сервере. Сейчас они намеренно расположены в конфиге, для простоты использования.

- Лимиты и max_exposure_usd — обязательные «страховочные» параметры.

________________________________________
## Быстрый запуск

- Установите зависимости:
```
pip install -r requirements.txt
```

- Отредактируйте config.json (установите dry_run: true для теста).

- Запустите:
```
python main.py
```

По всем вопросам пишите в → [Telegram канал](https://t.me/itpolice)

________________________________________
## UPD 15/09/2025 "Управление портфелем" + отчеты о проверке сигналов

- Добавлен простой портфель self.positions.

- Каждая покупка (buy) сохраняется с ценой входа и объёмом.

- Метод manage_positions() проверяет условия (sell_on_profit_usd, sell_on_return) и закрывает позицию продажей.

- Позиции остаются в истории (state: "closed"), можно потом выгружать статистику.

- Все прогнозы buy, sell теперь публикуются в [Telegram канале](https://t.me/aignal_tech) с отчетом о проверке сигнала.

________________________________________
## UPD 16/09/2025 Торговля на демо-счете

- в config.json добавлено поле "simulated_trading" для управлением режимами торговли.

________________________________________
## SEO-оптимизация (мета-теги)
- Title: Криптовалютный торговый бот с ИИ-сигналами AIgnal.tech – автоматическая торговля на Binance/Bybit/OKX | AI-бот для крипты
- Description: Торговый бот на Python с машин-лернинг сигналами от AIgnal.tech API: автоматический вход/выход, риск-менеджмент, поддержка Spot и Futures Binance, Bybit, OKX. Подключи ML-прогнозы криптовалют за 5 минут и получай прибыль 24/7.
- Keywords: криптовалютный торговый бот, AI-бот для крипты, AIgnal.tech API, machine learning сигналы крипта, автоматическая торговля Binance, Python бот для Binance, Bybit, OKX, торговый бот, ML-прогнозы криптовалют, ИИ сигналы Bitcoin, Ethereum, крипто-бот с ИИ, API AIgnal, криптобот 2025
- H1: AI-бот для криптовалютной торговли: готовые ML-сигналы AIgnal.tech прямо в ваш Telegram
